extends ../layout

block content
  .container-fluid.px-4
    .d-flex.justify-content-between.align-items-center.mb-4
      h1.mb-0 Asset History
      a.btn.btn-secondary(href='/assets')
        i.fas.fa-arrow-left.me-2
        | Back to Assets
    
    // Asset Selection Table Section - displays all assets for history viewing
    .card
      .card-header
        h5.mb-0 Select Asset for History
      .card-body
        // Responsive table container
        .table-responsive
          // Main assets table with DataTable functionality
          table#assetsTable.table.table-striped.table-hover
            // Table header with column names
            thead
              tr
                th Asset Name
                th Asset Tag
                th Category
                th Serial Number
                th Status
                th Actions
            // Table body with asset data
            tbody
              // Loop through each asset and display as a table row
              each asset in assets
                tr
                  // Asset name column
                  td= asset.name
                  // Asset tag column (shows 'N/A' if empty)
                  td= asset.asset_tag || 'N/A'
                  // Category name column (shows 'Uncategorized' if no category)
                  td= asset.Category ? asset.Category.name : 'Uncategorized'
                  // Serial number column (shows 'N/A' if empty)
                  td= asset.serial_number || 'N/A'
                  // Status column with color-coded badge
                  td
                    span.badge.rounded-pill(class={
                      'bg-success': asset.status === 'available',
                      'bg-primary': asset.status === 'assigned',
                      'bg-warning': asset.status === 'under_maintenance',
                      'bg-secondary': asset.status === 'retired'
                    })= asset.status.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')
                  // Actions column with history view button
                  td
                    // View history button for this specific asset
                    a.btn.btn-sm.btn-outline-primary(href=`/asset-history/${asset.id}`)
                      i.fas.fa-history.me-2
                      | View History

// JavaScript Section - contains all interactive functionality
block scripts
  script.
    // Wait for page to fully load before running JavaScript
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize DataTable for assets table - makes the table searchable and sortable
      $('#assetsTable').DataTable({
        pageLength: 25  // Show 25 rows per page
      });
    });
