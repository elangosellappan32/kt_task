extends ../layout

block content
  .container-fluid.px-4
    .d-flex.justify-content-between.align-items-center.mb-4
      h1.mb-0 Asset Details
      .btn-group
        a.btn.btn-outline-primary(href=`/assets/edit/${asset.id}`)
          i.fas.fa-edit.me-2
          | Edit Asset
        a.btn.btn-outline-secondary(href='/assets')
          i.fas.fa-arrow-left.me-2
          | Back to Assets
    .row
      .col-md-8
        .card
          .card-header
            h5.mb-0 Asset Information
          .card-body
            .row.mb-3
              .col-sm-4.fw-bold Asset Tag:
              .col-sm-8= asset.asset_tag || 'N/A'
            .row.mb-3
              .col-sm-4.fw-bold Serial Number:
              .col-sm-8= asset.serial_number || 'N/A'
            .row.mb-3
              .col-sm-4.fw-bold Name:
              .col-sm-8= asset.name
            .row.mb-3
              .col-sm-4.fw-bold Model:
              .col-sm-8= asset.model || 'N/A'
            .row.mb-3
              .col-sm-4.fw-bold Manufacturer:
              .col-sm-8= asset.manufacturer || 'N/A'
            .row.mb-3
              .col-sm-4.fw-bold Category:
              .col-sm-8= asset.Category ? asset.Category.name : 'Uncategorized'
            .row.mb-3
              .col-sm-4.fw-bold Status:
              .col-sm-8
                span.badge.rounded-pill(class={
                  'bg-success': asset.status === 'available',      // Green for available
                  'bg-primary': asset.status === 'assigned',         // Blue for assigned
                  'bg-warning': asset.status === 'under_maintenance', // Yellow for maintenance
                  'bg-secondary': asset.status === 'retired'         // Gray for retired
                })= asset.status.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')
            .row.mb-3
              .col-sm-4.fw-bold Branch:
              .col-sm-8= asset.branch || 'N/A'
            .row.mb-3
              .col-sm-4.fw-bold Location:
              .col-sm-8= asset.location || 'N/A'
            if asset.notes
              .row.mb-3
                .col-sm-4.fw-bold Notes:
                .col-sm-8= asset.notes
      
      .col-md-4
        // Financial Information Card
        .card.mb-3
          .card-header
            h5.mb-0 Financial Information
          .card-body
            // Purchase Date row (formatted as readable date)
            .row.mb-3
              .col-sm-5.fw-bold Purchase Date:
              .col-sm-7= asset.purchase_date ? new Date(asset.purchase_date).toLocaleDateString() : 'N/A'
            // Purchase Cost row (formatted as currency)
            .row.mb-3
              .col-sm-5.fw-bold Purchase Cost:
              .col-sm-7= asset.purchase_cost ? `₹${parseFloat(asset.purchase_cost).toFixed(2)}` : 'N/A'
            .row.mb-3
              .col-sm-5.fw-bold Current Value:
              .col-sm-7= asset.current_value ? `₹${parseFloat(asset.current_value).toFixed(2)}` : 'N/A'
            .row.mb-3
              .col-sm-5.fw-bold Warranty:
              .col-sm-7= asset.warranty_months ? `${asset.warranty_months} months` : 'N/A'
        .card
          .card-header
            h5.mb-0 Status
          .card-body
            .form-check
              // Checkbox showing 
              input.form-check-input(type='checkbox', checked=asset.is_active, disabled)
              label.form-check-label Active
    
    // Assignment History Section
    if asset.assignments && asset.assignments.length > 0
      .card.mt-4
        .card-header
          h5.mb-0 Assignment History
        .card-body
          .table-responsive
            table.table.table-striped
              thead
                tr
                  th Employee
                  th Assigned Date
                  th Return Date
                  th Status
              tbody
                each assignment in asset.assignments
                  tr
                    td= assignment.employee ? `${assignment.employee.first_name} ${assignment.employee.last_name}` : 'N/A'
                    td= new Date(assignment.assigned_date).toLocaleDateString()
                    td= assignment.return_date ? new Date(assignment.return_date).toLocaleDateString() : '—'
                    td
                      span.badge.rounded-pill(class={
                        'bg-primary': assignment.status === 'assigned',   // Blue for currently assigned
                        'bg-success': assignment.status === 'returned',   // Green for returned
                        'bg-danger': assignment.status === 'lost',        // Red for lost
                        'bg-warning': assignment.status === 'damaged'     // Yellow for damaged
                      })= assignment.status.charAt(0).toUpperCase() + assignment.status.slice(1)
